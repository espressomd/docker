FROM centos/devtoolset-6-toolchain-centos7
USER root
RUN yum -y install epel-release && yum -y install \
  blas-devel \
  boost169-devel \
  boost169-openmpi-devel \
  ccache \
  cmake3 \
  fftw-devel \
  gdb \
  git \
  hdf5-openmpi-devel \
  lapack-devel \
  make \
  openmpi-devel \
  python36 \
  python36-devel \
  python36-Cython \
  python36-numpy \
  python36-scipy \
  python36-pip \
  python36-setuptools \
  vim \
  which \
  zlib-devel \
  && yum clean all \
  && ln -s /usr/bin/cmake3 /usr/bin/cmake
ENV BOOST_INCLUDEDIR=/usr/include/boost169
ENV BOOST_LIBRARYDIR=/usr/lib64/boost169
RUN ln -s /usr/lib64/openmpi/lib/boost169/libboost_mpi.so  /usr/lib64/boost169/libboost_mpi.so
RUN useradd -m espresso -u 1000
USER 1000
ENV HOME="/home/espresso"
# install Python3 packages locally
RUN pip3 install --user h5py 'numpy==1.14.0'
WORKDIR /home/espresso
